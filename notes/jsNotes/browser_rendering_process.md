# browser's rendering process

## introduction

요청된 웹 페이지를 불러오기 위해 브라우저는 프로그래밍 언어로 쓰인 문서를 트리 구조로 파싱한다. 이 파싱된 트리 구조 데이터가 시각화되는 과정을 렌더링이라고 한다.

사용자가 브라우저 주소막대 UI에 URL을 입력하면, 브라우저는 DNS 서버에 요청을 보내 해당 일치하는 IP 주소를 찾는다. 이후 브라우저는 해당 IP 주소로 HTTP 요청을 보내고, 서버는 요청된 웹 페이지를 브라우저로 전송한다.

## HTTP

브라우저는 HTTP라는 프로토콜에 따라 서버와 통신한다. HTTP/1.1은 매 연결마다 하나의 요청/응답 쌍만을 처리할 수 있어, 요청이 많을수록 응답 완료가 지연된다. 반면 HTTP/2.0은 하나의 연결에서 다수 요청 및 응답을 처리할 수 있어, 이전 버전보다 약 50% 빠르다.

## HTML과 CSS 파일을 DOM 및 CSSOM으로 파싱

서버로부터 2진수 형태 바이트코드로 HTML 파일을 받으면, 브라우저는 이를 `<meta>` 태그의 `charset` 속성을 참고하여 문자열 형태로 변환한다.

그러면 해석된 문서가 토큰(문서의 최소 유닛)으로 나누어지고, 토큰들은 객체 형태의 트리 데이터 구조인 DOM(Document Object Model)으로 변환된다.

그런데 이 과정은 렌더링 엔진이 CSS 파일을 로딩하는 `<link>`나 `<style>` 태그를 만나면 정지하여, 동일한 과정(바이트코드 -> 문자열 -> 토큰 -> CSSOM)을 통해 CSSOM(CSS Object Model)을 생성한다.

렌더링 엔진은 HTML과 CSS 문서로부터 개별적인 DOM 및 CSSOM을 생성하는데, 이 객체 모델들은 렌더 트리라 하는 트리 구조로 결합된다. 그러면 브라우저는 이 렌더 트리에 기반하여 페이지를 페인팅한다.

## 자바스크립트 파일의 파싱 및 실행

렌더링 엔진은 CSS 파일을 로딩할 때와 동일하게, 자바스크립트 파일을 로딩하는 `<script>` 태그를 만날 때마다 자바스크립트의 파싱을 수행할 자바스크립트 엔진에 제어권을 넘긴다.

자바스크립트 엔진은 자바스크립트 파일을 토큰으로 분리하고(tokenizing), 이 토큰을 분석하여 AST(Abstract Syntax Tree)로 변환한다. 이후 AST는 자바스크립트 인터프리터가 이해하고 실행할 수 있는 바이트코드로 변환되며, 자바스크립트 최적화 컴파일러가 이를 최적화된 머신 코드로 컴파일한다.
